{% extends 'social/base.html' %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card mt-4">
                <div class="card-header text-center">
                    <h4 style="color: #ffffff;">Ù„Ø¹Ø¨Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø©</h4>
                </div>
                <div class="alert alert-warning">
    <i class="fas fa-exclamation-triangle"></i>
    Ø³ØªØªÙˆÙØ± Ù„Ø¹Ø¨Ø© GTA 6 Ù‡Ù†Ø§ Ù‚Ø±ÙŠØ¨Ø§ Ù‡Ø®Ø®Ø®Ø®
</div>
                <div class="card-body text-center">
                    <p class="text-muted">Ø§Ø®ØªØ¨Ø± Ø°Ø§ÙƒØ±ØªÙƒ Ø¨Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø£Ø²ÙˆØ§Ø¬!</p>
                    
                    <div class="game-container mb-4">
                        <div class="game-board" id="gameBoard"></div>
                    </div>
                    
                    <div class="game-info">
                        <p style="color: #ffffff;">Ø§Ù„ÙˆÙ‚Øª : <span id="time">00:00</span></p>
                        <p style="color: #ffffff;">Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª : <span id="moves">0</span></p>
                        <button id="restartBtn" class="btn btn-primary mt-3">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø¯Ø¡</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .game-container {
        display: flex;
        justify-content: center;
    }
    
    .game-board {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
        max-width: 300px;
    }
    
    .card-game {
        width: 60px;
        height: 60px;
        background-color: var(--bg-darker);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid var(--border);
    }
    
    .card-game.flipped {
        background-color: var(--primary);
        color: var(--bg-light);
        transform: rotateY(180deg);
    }
    
    .card-game.matched {
        background-color: #198754;
        cursor: default;
    }
    
    .game-info {
        margin-top: 20px;
    }
    
    @media (max-width: 576px) {
        .game-board {
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }
        
        .card-game {
            width: 50px;
            height: 50px;
            font-size: 20px;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const gameBoard = document.getElementById('gameBoard');
        const timeDisplay = document.getElementById('time');
        const movesDisplay = document.getElementById('moves');
        const restartBtn = document.getElementById('restartBtn');
        
        const emojis = ['ğŸ¶', 'ğŸ±', 'ğŸ­', 'ğŸ¹', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼'];
        let cards = [...emojis, ...emojis];
        let flippedCards = [];
        let matchedCards = [];
        let moves = 0;
        let seconds = 0;
        let timer;
        let gameStarted = false;
        
        // Ø®Ù„Ø· Ø§Ù„Ø£ÙˆØ±Ø§Ù‚
        function shuffleCards() {
            for (let i = cards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [cards[i], cards[j]] = [cards[j], cards[i]];
            }
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
        function createBoard() {
            gameBoard.innerHTML = '';
            shuffleCards();
            
            cards.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.classList.add('card-game');
                card.dataset.index = index;
                card.textContent = emoji;
                card.addEventListener('click', flipCard);
                gameBoard.appendChild(card);
            });
        }
        
        // Ù‚Ù„Ø¨ Ø§Ù„ÙˆØ±Ù‚Ø©
        function flipCard() {
            if (!gameStarted) {
                startTimer();
                gameStarted = true;
            }
            
            const selectedCard = this;
            
            // Ù…Ù†Ø¹ Ù‚Ù„Ø¨ ÙˆØ±Ù‚Ø© Ù…Ù‚Ù„ÙˆØ¨Ø© Ø£Ùˆ Ù…ØªØ·Ø§Ø¨Ù‚Ø©
            if (flippedCards.includes(selectedCard) || selectedCard.classList.contains('matched')) {
                return;
            }
            
            // Ù‚Ù„Ø¨ Ø§Ù„ÙˆØ±Ù‚Ø©
            selectedCard.classList.add('flipped');
            flippedCards.push(selectedCard);
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ·Ø§Ø¨Ù‚ Ø¹Ù†Ø¯ Ù‚Ù„Ø¨ ÙˆØ±Ù‚ØªÙŠÙ†
            if (flippedCards.length === 2) {
                moves++;
                movesDisplay.textContent = moves;
                
                const [firstCard, secondCard] = flippedCards;
                
                if (firstCard.textContent === secondCard.textContent) {
                    // ØªØ·Ø§Ø¨Ù‚ Ù†Ø§Ø¬Ø­
                    firstCard.classList.add('matched');
                    secondCard.classList.add('matched');
                    matchedCards.push(firstCard, secondCard);
                    flippedCards = [];
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙÙˆØ² Ø§Ù„Ù„Ø§Ø¹Ø¨
                    if (matchedCards.length === cards.length) {
                        clearInterval(timer);
                        setTimeout(() => {
                            alert(`Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ ÙØ²Øª Ø¨Ù€ ${moves} Ù…Ø­Ø§ÙˆÙ„Ø© ÙˆÙÙŠ ${formatTime(seconds)}!`);
                        }, 500);
                    }
                } else {
                    // Ø¹Ø¯Ù… ØªØ·Ø§Ø¨Ù‚
                    setTimeout(() => {
                        firstCard.classList.remove('flipped');
                        secondCard.classList.remove('flipped');
                        flippedCards = [];
                    }, 1000);
                }
            }
        }
        
        // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª
        function startTimer() {
            clearInterval(timer);
            seconds = 0;
            updateTimer();
            timer = setInterval(() => {
                seconds++;
                updateTimer();
            }, 1000);
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¤Ù‚Øª
        function updateTimer() {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            timeDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }
        
        // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª
        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${minutes} Ø¯Ù‚ÙŠÙ‚Ø© Ùˆ ${seconds} Ø«Ø§Ù†ÙŠØ©`;
        }
        
        // Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
        function restartGame() {
            flippedCards = [];
            matchedCards = [];
            moves = 0;
            gameStarted = false;
            movesDisplay.textContent = moves;
            clearInterval(timer);
            timeDisplay.textContent = '00:00';
            createBoard();
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø¯Ø¡
        restartBtn.addEventListener('click', restartGame);
        
        // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
        createBoard();
    });
</script>
{% endblock %}